---
title:  "쿠버네티스(k8s) 개요"
excerpt: "쿠버네티스(k8s) 개요 입니다."

categories:
  - kubernetes
tags:
  - [kubernetes]

toc: true
toc_sticky: true

last_modified_at: 2023-03-09T20:00:00-05:00
---

## [쿠버네티스]란 무엇일까?
### 쿠버네티스 사용하는 이유


### 쿠버네티스로 할 수 있는 것들
1. A 기능
설명입니다

2. B 기능
설명입니다

3. C 기능
설명입니다

## 컨테이너
### 도커파일(컨테이너) 만들기(node.js)
```bash
mkdir hellojs
cd hellojs
vi hello.js

```  
```js
const http = require("http");
const os = require("os");
console.log("Test server starting...");

var handler = function (request, response) {
	console.log("Received request from " + request.connection.remoteAddress);
	response.writeHead(200);
	response.end("Container Hostname: " + os.hostname() + "\n");
};
var www = http.createServer(handler);
www.listen(8080);

```  
8080 포트로 접속한 클라이언트에게 컨테이너 호스트네임을 송출해주는 어플리케이션이다.  
1. 웹서비스http와 os 정보를 변수에 수집
2. 콘솔창에 Test Server starting 콘솔메세지 출력
3. 8080포트를 열어서 클라이언트 요청을 대기
4. 요청이 오면 200번 상태코드와 컨테이너 호스트네임이라는 메세지를 전달

### 도커파일(컨테이너) 만들기(node.js 파일)
```bash
cd hellojs
vi Dockerfile

cat > Dockerfile
FROM node:16
COPY hello.js /
CMD ["node", "/hello.js"]

```
1. FROM 을 통해 nodejs 16 런타임 다운로드 받고
2. COPY 를 통해 hello.js 파일을 복사하고
3. CMD 명령을 통해 node hello.js 를 실행

### 도커파일 빌드(Build)```
```bash
cd hellojs

docker build -t hellojs:latest . # 빌드 (끝에는 컨테이너이름을 넣어준다)
docker images                    # 빌드로 만들어진 이미지 확인

```
위에 도커파일 내용이 순차적으로 실행된다. 즉, 도커 빌드하면 하나의 컨테이너가 하드디스크 안에 만들어진다.  
(앞서 다운로드받은 node16 과 제작한 hellojs 이미지가 있다)  

### 도커파일(컨테이너) 만들기(웹서버)
```bash
mkdir webserver
cd webserver
vi Dockerfile

FROM ubuntu:18.04
LABEL maintainer="Espeniel <apple@naver.com>"
# install apache
RUN apt-get update \
	&& apt-get install -y apache2
RUN echo "TEST WEB" > /var/www/html/index.html
EXPOSE 80
CMD ["/usr/sbin/apache2ctl", "-DFOREGROUND"]

```

### 도커파일 빌드(Build)```
```bash
cd webserver

docker build -t webserver:v1 .   # 빌드 (끝에는 컨테이너이름을 넣어준다)
docker images                    # 빌드로 만들어진 이미지 확인

```
위 내용과 동일하다. 이미지가 만들어진다.  
1. 우분투 이미지와, 
2. 방금 만든 webserver 이미지가 추가 되었다.


### 도커파일 푸쉬(optional)

```bash
docker push webserver:v1 .

```

푸쉬(push)는 선택적인 부분인 듯 하다.  
도커컨테이너를 저장하는 저장소안에 저장한다.

### 도커파일 실행
```bash
docker run -d -p 80:80 --name web webserver:v1

# 접속 해보자.
curl localhost:80
Test server starting...

```





