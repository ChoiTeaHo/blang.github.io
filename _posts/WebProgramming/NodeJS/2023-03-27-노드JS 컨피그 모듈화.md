컨트롤러
title:  "노드JS 컨피그 모듈화"
excerpt: "노드JS 컨피그 모듈화 입니다."

categories:
  - nodejs
tags:
  - [node.js]

toc: true
toc_sticky: true

last_modified_at: 2023-03-24T20:00:00-05:00
---

## 개요
메인을 수정하지 않아도 설정파일 조작만으로 반영할 수 있기 때문에 분리시킨다.  
  
***Example)***  
1. 서버를 실행하는 데 필요한 정보
2. 데이터베이스 정보 등을 담아둔다.


## 컨피그 디렉토리 생성
```bash
mkdir config

```

## 컨피그 유형
대표적인 컨피그 파일 유형은 아래와 같다.

1. .env
2. *.yml (YAML files)
3. *.ini (normally Windows-only)
4. *.json

## STEP1. 환경변수(process.env.NODE_ENV) 구현
### OS 환경변수 생성
```bash
export NODE_ENV=production

```

### 사용예시
```js
const env = process.env.NODE_ENV || 'development';

if (env === 'production') {
  console.log('Running in production mode');
} else {
  console.log('Running in development mode');
}

```


> process.env.NODE_ENV가 설정되어 있지 않은 경우 기본값으로 development 가 할당된다.


## STEP2. *.json을 이용한 방법



## STEP3. .gitEgnore
```
다섯 번째. .gitignore 파일 생성.
——
touch .gitignore
——
.gitignore 을 생성해주고, 안에 /node_modules 을 입력.
——
/node_modules
——
=> 이게 뭔 소리냐. 프로젝트를 git 에 업로드 할 건데, zoom 폴더 안의 node_modules 는 업로드 하지 않겠다 라는 의미. 업로드 하면 미친 짓.
```


## STEP4. *.env 이용방법
### dotenv 패키지를 설치
```bash
npm install dotenv #.env 파일에서 환경 변수를 로드하는 패키지

``` 

### .env 파일 작성
```js
  #PROJECT config
  NODE_MODE=dev

  #DB config
  host = blang.co.kr,
  port = 3306,
  user = "INSTC",
  password = "a",
  database := "DSDBDO0",
  connectionLimit: 10

```

### .env 파일에서 로드된 환경 변수를 사용
```js
/**
 * express.static, 정적 파일 서비스 제공
 */
//path.resoleve : os에 따라 /public 혹은 \public 처럼 분리자가 다를 수 있지만 이 부분을 처리해 준다.
//__dirname : 현재 위치를 가리키는 node 전역변수
var path = require("/config");
var publicPath = path.resolve(__dirname, "public");

require('dotenv').config()

```

주의할 점은 dotenv 패키지를 사용하기 전에 .env 파일을 만들고 환경 변수를 정의해야합니다. 그렇지 않으면 dotenv 패키지를 사용하여 환경 변수를 로드 할 수 없습니다.



