---
title:  "JS 토스트UI 그리드(1)"
excerpt: "JS 토스트UI 그리드(1) 입니다."

categories:
  - html-css-js-jquery
tags:
  - [HTML,CSS,JS,jquery]

toc: true
toc_sticky: true

last_modified_at: 2023-08-04T20:00:00-05:00
---

## 메인
### main.jsp
```jsp
<%@page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>

<!DOCTYPE html>
<head>
<jsp:iclude page="/WEB-INF/jsp/common/toast_ui.jsp" flush="false">
</head>
<body>

<!-- 파이 차트 -->
<div id="pie-chart1" class="chart"></div>
<span id="la1">Total\n값</span>
<span id="la2">Total\n값</span>

<!-- 라인 차트 -->
<div id="line-chart1" class="chart"></div>

<!-- 그리드 -->
<div id="grid1" class="chart"></div>

</body>


<script type="text/javascript">
/**********************************************************************
* 초기화
**********************************************************************/
var clusterMetrics = "";
var clusterRunning = "";
var clusterAccepted = "";
var pieChart1; 
var lineChart1; 

/**********************************************************************
* Toast Ui Chart 초기기렌더링을 위한 초기값 셋팅
**********************************************************************/
var paramData = {};
fnSyncAjax("POST", "/yarn/getYarnResource", paramData, function(result) {
    clusterMetrics = result[0].metrics[0];
    clusterRunning = result[1].running;
    clusterAccepted = result[2].accepted;
});

/**********************************************************************
* Toast Ui Chart
**********************************************************************/

$(document).ready(function() {


    $("#la1").text("Total\n" + bytesToGiga(clusterMetrics.totalMB) + " Gi");
    $("#la2").text("Total\n" + clusterMetrics.totalVirtualCores + " Gi");

    // Toast UI Create
    pieChart1 = fnCreatePieChart1(Chart, clusterMetrics); 
    lineChart1 = fnCreateLineChart1(Chart, clusterMetrics); 
    grid1 = fnCreateGrid1(Grid, clusterRunning); 

    // 실시간데이터
    setInterval(function() {
        var paramData = {};
        fnSyncAjax1("POST", "/yarn/getYarnResource", paramData, function(result) {
            
            // STEP1. GET DATA
            clusterMetrics = result[0].metrics[0];
            clusterRunning = result[1].running;
            clusterAccepted = result[2].accepted;

            // STEP2. DATA 가공 및 검증
            let resultData1 = fnToastGetData("pieChart1", clusterMetrics);
            let resultData3 = fnToastGetData("lineChart1", clusterMetrics);
            let resultData4 = fnToastGetData("grid1", clusterRunning);

            // STEP3. SET DATA
            pieChart1.setData(resultData1, 'memory-mb-usages');
            lineChart1.addData(resultData3, lineChart1.store.state.categories[4]+1);
            grid1.resetData(resultData4);

            $("#la1").text("Total\n" + bytesToGiga(clusterMetrics.totalMB) + " Gi");
            $("#la2").text("Total\n" + clusterMetrics.totalVirtualCores + " Gi");
        });
    }, 10000);


});

</script>

```


## 라이브러리 관련 커스텀한 js 임포트
### toast_ui.jsp
```jsp
<%-- toastUI Chart--%>
<link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/toastui-chart.min.css" media="screen" />
<script src="${pageContext.request.contextPath}/resources/js/toastui-chart.min.js"></script>

<%-- toastUI Grid --%>
<link rel="stylesheet" href="${pageContext.request.contextPath}/resources/css/tui-grid.min.css" media="screen" />
<script src="${pageContext.request.contextPath}/resources/js/tui-grid.min.js"></script>

<script>
/**********************************************************************
* TOAST UI CHART
**********************************************************************/
let Chart = new toastui.Chart;

/**********************************************************************
* TOAST UI Grid
**********************************************************************/
let Grid = tui.Grid;
var extOptions = {
    selection: {
        background: '#4daaf9', 
        border: '#004082'
    }, 
    row: {
        even: {
            background: '#eaeaea'
        },
        hover: {
            background: '#ccc'
        }
    }, 
    cell: {
        normal: {
            background: '#fbfbfb', 
            border: '#e0e0e0', 
            showVerticalBorder: true
        }, 
        header: {
            background: '#eee', 
            border: '#ccc', 
            showVerticalBorder: true
        }, 
        editable: {
            background: '#fbfbfb'
        },
        focused: {
            border: '#418ed4'
        }, 
        disabled: {
            text: '#b0b0b0'
        }, 
        eventRow: {
            background: '#fee'
        }
    }
};

Grid.applyTheme('default', extOptions);

/**********************************************************************
* Pie 차트1
**********************************************************************/
// 생략

/**********************************************************************
* line 차트1
**********************************************************************/
// 생략 

/**********************************************************************
* Grid1
**********************************************************************/
function fnCreateGrid1(Grid, clusterRunning) {
    return new Grid({
        el: document.getElementById('grid1');
        rowHeaders: [
            {
                type: 'rowNum', 
                header: 'No'
            }
        ], 
        columns: [
            {
                header: 'User', 
                name: 'user', 
                width: 90
            }, 
            {
                header: 'AllocatedVCores', 
                name: 'allocatedVCores', 
                width: 145
            }, 
            {
                header: 'AllocatedMB', 
                name: 'allocatedMB', 
                width: 125
            }, 
            {
                header: 'StartedTime', 
                name: 'startedTime', 
                width: 160
            }, 
            {
                header: 'LaunchTime', 
                name: 'user', 
                width: 160
            }, 
            {
                header: 'ElapsedTime', 
                name: 'elapsedTime', 
                width: 140
            }, 
            {
                header: 'Queue', 
                name: 'queue', 
                width: 110
            }, 
            {
                header: 'QueueUsagePercentage', 
                name: 'queueUsagePercentage', 
                width: 190
            }, 
            {
                header: 'ClusterUsagePercentage', 
                name: 'clusterUsagePercentage', 
                width: 206
            }
        ], 
        data: fnToastGetData("grid1", clusterRunning), 
        scrollX: false, 
        scrollY: true, 
        bodyHeight: 335 
    });
    
}


/**********************************************************************
* TOAST UI DATA SET
**********************************************************************/
function fnToastGetData(name, resData) {

    let resultData;
    let resultArrData = [];

    switch (name) {
    case "pieChart1":

        let allocatedMBPercent = parseFloat(((resData.allocatedMB / resData.totalMB) * 100).toFixed(2));
        let availableMBPercent = parseFloat(((resData.availableMB / resData.totalMB) * 100).toFixed(2));

        resultData = 
            !resData ? 
            {
                categories: ['memory-mb-usages'], 
                series: [
                        { name: 'Used = 0 Gi', data: 0.0} 
                        , { name: 'available = 0 Gi', data: 0.0} 
                        ]
            }
            :
            {
                categories: ['memory-mb-usages'], 
                series: [
                        { name: 'Used = ' + bytesToGiga(resData.allocatedMB) + ' Gi', data: allocatedMBPercent } 
                        , { name: 'available = ' + bytesToGiga(resData.availableMB) + ' Gi', data: availableMBPercent } 
                        ]
            };
        break;
    
    case "lineChart1":
        resultArrData = [];
        if (resData) {
            resultArrData.push(resData.appsRunning); 
            resultArrData.push(resData.appsPending); 
        }
        return resultArrData;
        
    }
    return resultData;
}

//bytes To gigabaytes DATA
function bytesToGiga(param) {
    const bytes = param;
    const gigabytes = bytes / 1024;
    return gigabytes.toFixed(1);
}
</script>

```


