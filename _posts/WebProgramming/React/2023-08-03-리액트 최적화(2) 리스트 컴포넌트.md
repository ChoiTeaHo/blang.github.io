---
title:  "리액트 최적화(2) 리스트 컴포넌트"
excerpt: "리액트 최적화(2) 리스트 컴포넌트 입니다."

categories:
  - react
tags:
  - [react]

toc: true
toc_sticky: true

last_modified_at: 2023-08-03T09:00:00-18:00:00
---


## 리스트 컴포넌트 최적화

## 현재코드
### ScheduleBoard.js
```js
import React, { useRef, useState, useCallback } from 'react';
import TodoTemplate from './TodoTemplate';
import TodoInsert from './TodoInsert';
import TodoList from './TodoList';

function createBulkTodos() {
    const array = [];
    for(let i=1; i<2500; i++) {
        array.push( { id: i, text: `할 일 ${i}`, checked: false } );
    }

    return array;
}

const ScheduleBoard = () => {

    const [todos, setTodos] = useState(createBulkTodos);

    const nextId = useRef(todos.length);

    // 삽입
    // 갱신 되지지않지만 접근 방법을 자식컴포넌트에서 미리 useMemo 해놨다. 그래서 오버헤드는 없다.
    const onInsert = useCallback( (text) => {
        const temp = {
            id: nextId.current += 1
            , text: text
            , checked: false
        };
        setTodos(todos.concat(temp));
    }, []);

    // 삭제
    const onRemove = useCallback( (id) => {
        setTodos(todos => (todos.filter((todo) => todo.id !== id)));
    }, []);

    // 토글
    const onToggle = useCallback( (id) => {
        setTodos(todos => ( 
                            todos.map((todo) => 
                                todo.id === id ? { ...todo, checked: !todo.checked } : todo,
                            )
        ));
            
    }, []);
    
    return (
        <div>
            <h1>ScheduleBoard Page</h1>

            <TodoTemplate>
                <TodoInsert onInsert={onInsert} />
                <TodoList todos={todos} onRemove={onRemove} onToggle={onToggle} />
            </TodoTemplate>
        </div>

    );
};

export default ScheduleBoard;

```

> ❗***이전 포스팅 처럼 최적화가 된 상태이다.***  
> 💡 여기서 리스트를 렌더링하는 <TodoList /> 를 집중해서 보자.  
> 💡 등록된 props 는 [todos], [onRemove], [onTogle] 이다.  
>   
> ❗현재 리렌더링 조건  
> 💡 부모 컴포넌트의 리렌더링  
> 💡 todos 상태 변경  
> 💡 onInsert, onRemove, onToggle 함수의 변경 시점에 리렌더링  
>  
> ❗현재 리렌더링 조건  
> 💡 부모 컴포넌트의 리렌더링  
> 💡 todos 상태 변경  
> 💡 onInsert, onRemove, onToggle 함수의 변경 시점에 리렌더링  




### ScheduleBoard.js

- AS-IS

    ```js
    import TodoListItem from './TodoListItem';
    import '../TodoList.scss';

    const TodoList = ({ todos, onRemove, onToggle }) => {

        return (
            // 리스트 상세 컴포넌트
            <div className="TodoList">
                {todos.map(todo => (
                    <TodoListItem
                        todo={todo}
                        key={todo.id}
                        onRemove={onRemove}
                        onToggle={onToggle}
                    />
                ))}
            </div>

        );
    };

    export default TodoList;
    
    ```

- TO-BE   

    ```js
    import React from 'react';
    import TodoListItem from './TodoListItem';
    import '../TodoList.scss';

    const TodoList = ({ todos, onRemove, onToggle }) => {

        return (
            // 리스트 상세 컴포넌트
            <div className="TodoList">
                {todos.map(todo => (
                    <TodoListItem
                        todo={todo}
                        key={todo.id}
                        onRemove={onRemove}
                        onToggle={onToggle}
                    />
                ))}
            </div>

        );
    };

    export default React.memo(TodoList);  // React.Memo 사용
    
    ```

> ❗***리스트 컴포넌트 최적화***  
> 💡 리스트 컴포넌트를 사용한다면 리스트 내부에서 사용하는 컴포넌트도 최적화 해야한다.  
> 💡 리스트는 반복적으로 생성되기 때문이다. (갱신이 계속 일어난다.)  
>   
> ❗***이 코드에서는 영향이 없다.***  
> 💡 처리해줘서 나쁜건 없지만 반영해도 영향이 없다.  
> 💡 현재 부모컴포넌트가 렌더링되는 유일한 이유가 todos 배열이 업데이트 될때 수행되기 때문이다.  


