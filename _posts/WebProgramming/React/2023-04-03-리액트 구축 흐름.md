---
title:  "리액트 구축 흐름"
excerpt: "리액트 구축 흐름 입니다."

categories:
  - react
tags:
  - [react]

toc: true
toc_sticky: true

last_modified_at: 2023-04-03T20:00:00-05:00
---

## 리액트 구축 흐름
1. client랑 server 개발 방법은?

2. client랑 server 개발 후 실행 방법은?

3. client 산출물을 server로 전송하는 방법은?

4. git 저장소에 코드 업로드

## client랑 server 개발 방법은?
- <span style="color:green"><b>client 개발</b></span>  
    : client를 개발하는 방법은 react를 학습중이므로 설명못하겠다.. 현재는 create-react-app 후 개발용으로 react를 설치하고 실행 테스트하고 있다.

- <span style="color:green"><b>server 개발</b></span>  
    : node.js 또는 spring 등이 있을 것이다. 이전에 완성한 node.js 를 서버로 개발 진행한다면 다음과 같다.

    - Node.js  
      ```bash
      # 디렉토리 1depth 만 표현 :)
        tree
        . 
        ├── app.js
        ├── config
        ├── controllers
        ├── middlewares
        ├── models
        ├── node_modules
        ├── package-lock.json
        ├── package.json
        ├── public
        ├── routes
        └── server.js
        
        ```


## CASE1. 스프링-부트와 create-react-app을 함께 사용하기
### STEP1. 스프링-부트 프로젝트 생성
```bash
# 스프링-부트 프로젝트를 생성
# Maven 또는 Gradle을 사용하여 프로젝트를 생성할 수 있다. (이전 포스팅 참조^^)

```

### STEP2. create-react-app 프로젝트 생성
```bash
# 스프링-부트 프로젝트 디렉토리 내부에 프론트엔드 리액트 프로젝트를 생성 
# 스프링-부트 프로젝트의 루트 디렉토리에서 다음 명령을 실행 
npx create-react-app frontend 

```

### STEP3. 프로젝트 구조 설정
```bash
# 두 프로젝트를 하나로 통합 해야한다.
# 즉, 스프링-부트 프로젝트와 리액트 프로젝트를 하나의 프로젝트로 구성하도록 하자.

# (일반적으로 스프링-부트 프로젝트와 리액트 프로젝트는 각각 독립적으로 관리 된다.)

```

- ( AS-IS ) 스프링 프로젝트  

    ```bash
    - src/
    - main/
        - java/
        - resources/
    ```
  

- ( TO-BE ) 스프링 프로젝트  

    ```bash
    - src/
    - main/
        - java/
        - resources/
        - webapp/
        - frontend/  # 이곳에 리액트 프로젝트를 넣었다.
            - (리액트 프로젝트 내용)
    ```

### STEP4. 서버 설정
```bash
# 백앤드(스프링-부트) 서버 설정을 수정하여 프론트엔드 리액트 애플리케이션을 호스팅할 수 있도록 설정한다.

# (application.properties)
spring.resources.static-locations=classpath:/webapp/frontend/build/

```

> 위 설정은 스프링-부트가 / 경로로 요청이 오면 리액트 빌드한 정적 파일들이 있는 경로를 제공합니다.


### STEP5. 개발 모드에서 실행

단순하게 각각 실행하면 끝이다.  

- 백앤드

    ```bash
    cd [프로젝트 루트]

    # 백앤드 서버 실행
    mvn spring-boot:run # 메이븐
    gradle bootRun # 그래들

    ```

- 프론트 

    ```bash
    cd [프로젝트 루트]/src/main/frontend

    # 프론트 서버 실행
    npm start # 리액트 개발서버 실행

    ```

> ***서버 실행 확인)***  
> 웹 브라우저를 열고 각각의 주소로 접속하여 스프링-부트 서버와 리액트 개발 서버가 정상적으로 실행되는지 확인.
> - 스프링-부트 서버는 기본적으로 http://localhost:8080에서 실행
> - 리액트 개발 서버는 기본적으로 http://localhost:3000에서 실행
>   
> 이렇게 하면 개발 중에 리액트 개발 서버가 hot-reloading 기능을 제공하고, 스프링-부트 서버는 백엔드 로직을 처리하여 프론트엔드와 백엔드가 독립적으로 개발 및 테스트 가능하다. 
> 본 방법은 개발 환경에서 사용되며, 운영 환경에서는 빌드된 리액트 정적 자원을 스프링-부트에 포함하여 서빙하는 것이 일반적이다. 


### STEP6. 빌드와 배포 
```bash
# 1. 개발한 리액트 프로젝트를 빌드 
# 2. 개발한 스프링-부트 프로젝트를 빌드 (스프링-부트의 빌드 도구인 Maven 또는 Gradle을 사용하여 빌드)
# 3. 하나의 애플리케이션으로 패키징 
# 4. 패키징된 어플리케이션을 톰캣과 같은 WAS서버에 배포하면 끝 ! 

```

> 최종적으로 프론트엔드와 백엔드가 함께 호스팅되는 애플리케이션이 배포되었다. 


# 개발 모드에서는 스프링-부트 및 리액트 개발 서버를 함께 실행할 수 있다.

# - 스프링-부트 서버와 리액트 개발 서버를 병렬로 실행하면, 프론트엔드 개발 시 hot-reloading 기능을 사용할 수 있어서 편하다, 
# - 개발중에 CORS 이슈를 피할 수 있다. 

```



빌드와 배포: 개발이 완료되면 리액트 프로젝트를 빌드하고 스프링-부트 프로젝트를 빌드하여 하나의 애플리케이션으로 패키징하면 됩니다. 스프링-부트의 빌드 도구인 Maven 또는 Gradle을 사용하여 빌드하고, 패키징된 애플리케이션을 톰캣과 같은 서버에 배포하면 프론트엔드와 백엔드가 함께 호스팅되는 애플리케이션이 배포됩니다.









## 프론트서버와 백앤드서버 개발 후 실행 방법은?
### CASE1. 각각의 서버실행으로 운영하기 
순서는 다음과 같다.  

1. build 시키지 않고, 
2. 프론트 서버(리액트)를 실행한다. 
    ```bash
    # CASE1. 리액트 (3000 포트)
    npm start 

    ```

3. 백앤드 서버(톰캣)를 실행한다. 
    ```bash
    # CASE1. 노드JS(node server.js) (3001 포트)
    npm prod start
    npm dev start

    # CASE2. 톰캣 
    sh startup.sh

    ```

<span style="color:red"><b>각각의 서버를 띄우는 가장 간단한 방법</b></span>이다.  
프론트 서버에서 내부코드 변경분이 일어나면 프론트서버가 독립적으로 운영되므로 컴파일이 빠르게 가능하다. 그리고 백앤드서버는 조작없이 기존과 동일하게 프론트 서버의 자원을 바라만 보면된다.
  
<span style="color:red"><b>***즉, 백앤드서버 측에서 프론트서버 자원을 build 절차를 거치고 백앤드 서버를 재기동 할 필요도 없다.***</b></span>  

이와 반대로 1대의 백앤드에서 프론트 자원까지 관리한다면  
1. build 하고 빌드 결과를 서버측에 로드하고 실행 및 확인해야하고
2. 프론트 서버를 테스트할때 코드를 수정하면 자동 컴파일해주는 nodemo(노드몬)패키지등의 장점을 버려야한다. 백앤드 서버에 올리고 백앤드 서버를 재기동 해야하기 때문이다.
  
> <span style="color:blue"><b><I>결론은 개발 중일 때에는 이 방법(분리된 서버)으로 편리하게 백앤드 & 프론트 서버를 실행하고 테스트 하자 !</I></b></span>


### CASE2. 프론트 자원을 빌드한 리소스를 백앤드에서 운영하기
프론트 서버를 운영하지 않고 백앤드 서버에서 운영하는 방법이다. 

1. 프론트 자원을 build
    ```bash
    npm build # 빌드한 자원은 백앤드 서버로 업로드

    ```
2. 백앤드 서버 측에 업로드한 프론트자원 build/index.html 을 참조한다.

3. 백앤드 서버 재기동 (끝)


## 프론트 자원을 백앤드 서버측으로 전송하는 방법

그래서 어떻게 백앤드 서버측으로 빌드한 자원을 전송하는지 알아본다. (노드JS 사용기준이다.)

### STEP1. 프론트 자원 빌드
```bash
# 리액트 빌드
npm build

```


### STEP2. 프론트 자원을 백앤드 서버에 통합

- 톰캣인 경우
    - CASE1. 정적 자원을 별도의 디렉토리에 배치
    - CSAE2.
    스프링 프로젝트의 웹 애플리케이션 디렉토리(예: src/main/webapp 또는 src/main/resources/static)에 리액트 프로젝트에서 빌드한 정적 파일들을 복사합니다. 이렇게 하면 스프링 프로젝트가 리액트의 정적 파일들을 참조할 수 있게 됩니다.



```js
// 서버측 (server.js 전에 포스팅한 node.js 메인파일이다.)
app.use(express.static(path.join(__dirname, "/client/build")));

```

<span style="color:red"><b>client 자원 빌드하고 서버측에 올리면 끝이다.</b></span>  
client 개발이 끝나면, npm run build를 통해 하나의 build 폴더를 만들고, server에서 client의 build/index.html 파일을 참조(라우팅)하는 방식으로 로드할 수 있다.


### CASE4. git 저장소에 코드 업로드
server와 client 모두 개발했기 때문에 둘 모두를 업로드해야 한다.

- client   
    : `npm run build` 를 통해 build 된 폴더만 옮기면 된다. git 업로드를 위한 폴더를 구성한다.

- server
    : build 필요없이 그 자체로 옮겨준다.

이후 다음과 같다.
  
```bash
git init
git remote add origin <미리 받아놓은 저장소 주소>

git add *
git commit -m "first commit"
git push origin master

```

1. 버전관리폴더 초기화(.git 파일 생성)
2. 저장소 주소로 remote 설정
3. 모든 파일들을 올리기.

> [참고링크](https://velog.io/@peration/React-server-client-%EA%B0%9C%EB%B0%9C#1-client%EC%99%80-server%EB%A5%BC-%EC%96%B4%EB%96%BB%EA%B2%8C-%EA%B0%9C%EB%B0%9C%ED%95%98%EC%A7%80)  
> 참고로 여기서 gitignore로 숨길 파일이 전혀 없다.  
> 모든 파일을 다올려야 한다. (.env, /node_modules, packages.json 등등)
> (다시 적용해보니 /node_modules는 굳이 올리지 않아도 알아서 install 하는 것 같다. 고로 올리지 않아도 된다.)
> 그래야 server에서 인식하기 때문이다.  
