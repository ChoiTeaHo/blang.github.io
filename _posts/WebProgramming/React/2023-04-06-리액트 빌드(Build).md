---
title:  "리액트 빌드(Build)"
excerpt: "리액트 빌드(Build) 입니다."

categories:
  - react
tags:
  - [react]

toc: true
toc_sticky: true

last_modified_at: 2023-04-05T20:00:00-05:00
---

## 리액트 빌드 및 배포
### npm run build
F12 창에서 페이지 갱신하고 확인해보면 기본인데 리소스가 많이 잡아먹는다. (예를들면 hello react라는 문자만 넣었다고 가정하면 1.8MB나 된다.) 
현재 리액트는 개발의 편의성을 위해서 여러 가지 기능들을 추가해놓은 상태이기 때문에, 상<span style="color:red"><b>당히 무거운 편</b></span>이다. <span style="color:red"><b>이 파일을 그대로 유저가 이용하게 된다면 상당히 느려질 것</b></span>이다.

```bash
npm run build


tree
.
├── package.json
├── package-lock.json
├── bck # 리액트 앱 CREATE 한 프로젝트
│   ├── build  # 이 폴더가 생겼다 ! 
│   ├── README.md
│   ├── node_modules
│   ├── package-lock.json
│   ├── package.json
│   ├── public
│   └── src
└── node_modules

```

build라는 디렉토리가 새로 생긴다.  
이 안에 index.html을 열어보면 이상하게 나온다. 원래 사용했던 index.html 의 내용 등에서 불필요한 공백들과 같이 용량을 차지하는 녀석들을 전부 다 제거한다. <span style="color:red"><b>즉, 실제 서비스할 때는 build 안에 있는 파일들을 사용</b></span>하면 된다. 

### 백엔드에서 build 사용하기

1. Node.js(Express) 서버 환경  
    : 예를 들어 Node.js 기반의 Express 를 백엔드 서버로 쓴다면 다음과 같다ㅇ

    ```js  
    // 정적 파일이 모인 build 폴더를 static 으로 설정
    app.use(express.static(path.join(__dirname, '../ucb-front/build')));
    
    ```  
    ```bash
    # express의 엔트리 파일을 실행
    npm run start 

    ```
    <span style="color:red"><b>React 앱이 빌드된 정적 파일이 모인 build 폴더를 static 으로 설정 하면 끝이다.</b></span>   
    Express 서버에서 /ucb-front/build URL 경로로 요청이 들어오면 ../ucb-front/build 디렉토리에 있는 파일들을 클라이언트에게 제공하게 된다. 이를 통해 React 앱이 빌드된 정적 파일들을 Express 서버에서 호스팅할 수 있다.

2. 간단한 웹서버 환경(serve 모듈)
    : npm 에서 serve 라는 모듈을 사용한다면 다음과 같다.

    ```bash
    npm insatll serve
    npx serve -s build   # 한번만 실행

    # 기본 5000 포트를 사용한다.

      ┌──────────────────────────────────────────┐
      │                                                                  │
      │   Serving!                                                       │
      │                                                                  │
      │   - Local:    http://localhost:3000                              │
      │   - Network:  http://192.168.0.10:3000                           │
      │                                                                  │
      └──────────────────────────────────────────┘

    HTTP  2023. 4. 20. 오후 5:56:52 223.62.22.82 GET /
    HTTP  2023. 4. 20. 오후 5:56:52 223.62.22.82 Returned 200 in 227 ms
    HTTP  2023. 4. 20. 오후 5:56:53 223.62.22.82 GET /static/js/main.ae67edd3.js
    HTTP  2023. 4. 20. 오후 5:56:53 223.62.22.82 GET /static/css/main.f2eabf11.css
    HTTP  2023. 4. 20. 오후 5:56:53 223.62.22.82 Returned 200 in 17 ms
    HTTP  2023. 4. 20. 오후 5:56:53 223.62.22.82 Returned 200 in 26 ms
    HTTP  2023. 4. 20. 오후 5:56:53 223.62.22.82 GET /static/media/logo.6ce24c58023cc2f8fd88fe9d219db6c6.svg
    HTTP  2023. 4. 20. 오후 5:56:53 223.62.22.82 GET /logo192.png
    HTTP  2023. 4. 20. 오후 5:56:53 223.62.22.82 Returned 200 in 8 ms
    HTTP  2023. 4. 20. 오후 5:56:53 223.62.22.82 Returned 200 in 7 ms
    HTTP  2023. 4. 20. 오후 5:56:53 223.62.22.82 GET /favicon.ico
    HTTP  2023. 4. 20. 오후 5:56:53 223.62.22.82 Returned 200 in 4 ms
    
    ```

    serve는 node.js로 초간단하게 설치해서 실행 시킬 수 있는 웹서버 라고 할 수 있다. 주로 정적 파일을 호스팅하기 위해 사용한다.
    
    사용하는 이유는 다음과 같다.  
    - 로컬 개발 환경에서 정적 파일 또는 SPA를 쉽게 실행할 수 있다. 
    - 소규모 프로젝트나 프로토타입 개발에 적합하다.
    - Node.js와 연관된 구성 요소를 전혀 사용하지 않고 간단한 개발 서버를 실행할 수 있다.
    - 커스텀 설정으로 개발 서버를 확장할 수 있다.
    
    > 
    > <span style="color:blue"><b>***npm start VS serve 차이점***</b></span>  
    > npm start와 serve는 비슷한 역할을 수행하지만 목적이 다르다.  
    >   
    > <span style="color:green"><b>**npm start**</b></span>  
    > - package.json 파일의 scripts 섹션에서 start 키워드로 설정된 명령어를 실행하는 것 
    > - 로컬 개발 서버를 시작하고 애플리케이션을 브라우저에서 실행시킨다.
    > - 보통 React 프로젝트에서는 start 스크립트가 react-scripts start 명령어를 
    > 실행행하도록 설정되어 있다.   
    >  
    > <span style="color:green"><b>**serve**</b></span>  
    > - 정적 파일 서버를 시작하는 데 사용되는 도구. 
    > - 이를 사용하면 빌드된 React 애플리케이션을 서비스할 수 있다. 
    > - serve는 배포된 애플리케이션을 실행하는 데 유용하다.
    >   
    > <span style="color:red"><b>따라서 개발 중인 React 애플리케이션을 실행할 때는 npm start를 사용하고, 배포된 
    > 애플리케이션을 실행할 때는 serve를 사용하는 것이 적합하다.</b></span>   
    > 
    > 개발 서버에서 코드가 변경되면 자동으로 업데이트되어 새로고침 없이 바로 변경 사항을 확인할 수 있는 기능을 <span style="color:red"><b>핫리로딩</b></span> 이라고 한다. 그러나 <span style="color:red"><b>serve와 같은 정적 파일 서버를 사용하면 핫 리로딩 기능을 사용할 수 없다.</b></span> 이는 정적 파일 서버가 요청을 받으면 해당 파일을 반환하고, 서버에서 동적인 코드 실행 없이 파일을 그대로 전달하기 때문이다. 따라서 핫 리로딩 기능을 사용하려면 개발 서버에서 정적 파일 서버 대신에 코드를 실행하고 변경 사항을 자동으로 감지하여 적용할 수 있는 방법을 사용해야 한다.  
    대표적인 예시로는 webpack-dev-server가 있다.